<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script src="../static/js/jquery-2.0.0.min.js"></script>
    <script src="../static/js/ktor.js"></script>
    <script type="text/javascript">
        function runCode() {

            var fileCount = 2;
            var codeData = {};
            for (var i = 0; i < fileCount; i++) {
                codeData["filename" + i] = $("#filename" + i)[0].innerHTML;
                codeData["code" + i] = $("#code" + i)[0].value;
            }

            codeData["language"] = "lua";
            codeData["filecount"] = fileCount;
            codeData["start"] = "main.lua";

            $.ajax({
                url: "/codepack",
                type: "post",
                dataType: "json",
                data: codeData,
                success: function (data) {
                    if (data.result === 0)  {
                        $("#result")[0].innerHTML = "[Succ][output] " + data.output + "<br>[Succ][Error] " + data.error;
                    } else {
                        $("#result")[0].innerHTML = "[Failed][output] " + data.output + "<br>[Failed][Error] " + data.error;
                    }
                }
            });
        }
    </script>
</head>
<body>
<p>
<span id="filename0">main.lua</span><br>
<textarea id="code0" style="width: 20%; height: 200px; resize: none">
require("func")
local a = func.add(1, 2)
print(string.format("Hello, %d", a))
</textarea><br>
<span id="filename1">func.lua</span><br>
<textarea id="code1" style="width: 20%; height: 200px; resize: none">
func = {}
function func.add(x, y)
    return x + y
end
return func

</textarea><br>

</p>
<p>
<button onclick="runCode();">Run</button>
</p>
<p>
    <div id="result"></div>
</p>

</body>
</html>