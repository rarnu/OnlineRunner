<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>ObjC Editor</title>
    <script src="../static/js/allimport.js"></script>
    <link href="../static/css/demo.css" rel="stylesheet">
</head>
<body>

<div style="width: 40%; height: 30px; margin-top: 16px; margin-left: 30%; display: block;">
    <div style="float:left;  height: 30px;"><span style="height: 30px; vertical-align: middle; font-size: 1.5em;"><a
            href="index.html">ObjC Editor</a></span></div>
    <div style="float: right; ">
        <button onclick="javascript:editors.forEach(function (value) { value.setTheme(false); });" class="button-demo">Light</button>
        <button onclick="javascript:editors.forEach(function (value) { value.setTheme(true); });" class="button-demo">Dark</button>
    </div>
</div>

<div style="width: 40%; margin-top: 16px; margin-left: 30%">
    <p>
        <span>main.m</span><br>
    <div id="code0" style="width: 100%; height: 400px;"></div>
    </p>
    <p>
        <span>func.h</span><br>
    <div id="code1" style="width: 100%; height: 400px;"></div>
    </p>
    <p>
        <span>func.m</span><br>
    <div id="code2" style="width: 100%; height: 400px;"></div>
    </p>
</div>

<script type="text/javascript">
    var filecount = 3;
    var filenames = ["main.m", "func.h", "func.m"];
    var editors = [
        new CodeEditor($("#code0"), {
            language: "ObjC"
        }, {}),
        new CodeEditor($("#code1"), {
            language: "ObjC",
            canRun: false
        }, {}),
        new CodeEditor($("#code2"), {
            language: "ObjC",
            canRun: false
        }, {})
    ];

    editors[1].setCode("#import <Foundation/Foundation.h>\n@interface Func : NSObject\n+(int) add:(int) x y:(int) y;\n@end");
    editors[2].setCode("#import \"func.h\"\n@implementation Func\n+(int) add:(int)x y:(int)y {\n    return x + y;\n}\n@end");

    editors[0].onRun = function (lng, code, param) {

        var codeData = {};
        for (var i = 0; i < filecount; i++) {
            codeData["filename" + i] = filenames[i];
            codeData["code" + i] = editors[i].getCode();
        }

        codeData["language"] = lng;
        codeData["filecount"] = filecount;
        codeData["start"] = filenames[0];

        $.ajax({
            url: "/codepack",
            type: "post",
            dataType: "json",
            data: codeData,
            success: function (data) {
                editors[0].showResult(data);
            }
        });
    };

    $.ajax({
        url: "/svros",
        dataType: "json",
        success: function (data) {
            if (data.ismac) {
                editors[0].setCode("#import <Foundation/Foundation.h>\n#import \"func.h\"\nint main (){\n    int a = [Func add:1 y:2];\n    printf(\"%d\\n\", a);\n    return 0;\n}");
            } else {
                editors[0].setCode("#import <Foundation/Foundation.h>\n#import \"func.h\"\nint main (){\n    NSAutoreleasePool *pool = [[NSAutoreleasePool alloc] init];\n    int a = [Func add:1 y:2];\n    printf(\"%d\\n\", a);\n    [pool drain];\n    return 0;\n}");
            }
        }
    });
</script>

</body>
</html>