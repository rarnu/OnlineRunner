<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script src="../static/js/jquery-2.0.0.min.js"></script>
    <script src="../static/js/ktor.js"></script>
    <script type="text/javascript">
        function runCode() {

            var fileCount = 3;
            var codeData = {};
            for (var i = 0; i < fileCount; i++) {
                codeData["filename" + i] = $("#filename" + i)[0].innerHTML;
                codeData["code" + i] = $("#code" + i)[0].value;
            }

            codeData["language"] = "objc";
            codeData["filecount"] = fileCount;
            codeData["start"] = "main.m";

            $.ajax({
                url: "/codepack",
                type: "post",
                dataType: "json",
                data: codeData,
                success: function (data) {
                    if (data.result === 0)  {
                        $("#result")[0].innerHTML = "[Succ][output] " + data.output + "<br>[Succ][Error] " + data.error;
                    } else {
                        $("#result")[0].innerHTML = "[Failed][output] " + data.output + "<br>[Failed][Error] " + data.error;
                    }
                }
            });
        }
    </script>
</head>
<body>
<p>
<span id="filename0">main.m</span><br>
<textarea id="code0" style="width: 20%; height: 200px; resize: none">
#import <Foundation/Foundation.h>
#import "func.h"
int main (){
    NSAutoreleasePool *pool = [[NSAutoreleasePool alloc] init];
    int a = [Func add:1 y:2];
    NSLog(@"%d", a);
    printf("%d\n", a);
    [pool drain];
    return 0;
}
</textarea><br>
<span id="filename1">func.h</span><br>
<textarea id="code1" style="width: 20%; height: 200px; resize: none">
#import <Foundation/Foundation.h>
@interface Func : NSObject
+(int) add:(int) x y:(int) y;
@end
</textarea><br>
<span id="filename2">func.m</span><br>
<textarea id="code2" style="width: 20%; height: 200px; resize: none">
#import "func.h"
@implementation Func
+(int) add:(int)x y:(int)y {
    return x + y;
}
@end
</textarea>
</p>
<p>
<button onclick="runCode();">Run</button>
</p>
<p>
    <div id="result"></div>
</p>

</body>
</html>